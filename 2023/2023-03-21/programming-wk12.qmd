---
author: "Zahlen Zbinden"
title: "Programming Languages"
date: "11-17-2023"
format: pdf
---

## Setup

```{r setup, include = FALSE}
knitr::opts_chunk$set(
    echo = TRUE,
    message = FALSE,
    warning = FALSE
)
library(ggplot2)
library(showtext)
library(tidyverse)
library(ggsankey)
```

## Load Data

```{r}
tuesdata <- tidytuesdayR::tt_load(2023, week = 12)
languages <- tuesdata$languages
```

## Wrangle Data

```{r}
languages <- languages |>
              arrange(desc(number_of_users)) |>
              slice(1:20) 
```

## Load Fonts

```{r}
font_add_google("Roboto Mono", "robot")
showtext_auto()
```

## Plot Data

```{r}
language_plot <- languages |>
                  mutate(
                    title = ifelse(
                      title == "Arduino Programming Language",
                      "Arduino",
                      title
                    )
                  ) |>
                  mutate(
                    title = factor(
                      title,
                      levels = title[order(desc(number_of_users))]
                    ), 
                  ) |>
                  mutate(
                    label = paste("Comment token:", line_comment_token)
                  ) |>
                  select(
                    "title", 
                    "number_of_users",
                    "number_of_jobs",
                    "label"
                  ) |>
                  melt(id.vars = c("title", "label"))
```

```{r}
segment_plot <- languages |>
                  mutate(
                    title = ifelse(
                      title == "Arduino Programming Language",
                      "Arduino",
                      title
                    )
                  ) |>
                  mutate(
                    title = factor(
                      title,
                      levels = title[order(desc(number_of_users))]
                    ),
                  ) |>
                  mutate(
                    label = paste("Comment token:", line_comment_token)
                  ) |>
                  select(
                    "title",
                    "number_of_users",
                    "number_of_jobs",
                    "label"
                  )
```

## Plot

```{r}
language_plot |>
  ggplot(aes(x = value, y = title)) +
    geom_segment(
      data = segment_plot,
      aes(
        x = number_of_users,
        xend = number_of_jobs,
        y = title,
        yend = title
      ),
      size = 1
    ) +
    geom_point(
      aes(
        shape = variable,
        color = variable
      ),
      size = 5
    ) +
    scale_x_log10() +
    scale_shape_manual(
      values = c(0, 1), 
      labels = c("Number of Users", "Number of Jobs")
    ) +
    scale_color_manual(
      values = c("red", "blue"), 
      labels = c("Number of Users", "Number of Jobs")
    ) +
    facet_wrap(~ label, nrow = 2, scales = "free_y")
```